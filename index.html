<!DOCTYPE html>
<html>
  <head>
    <b>Weather Info</b>
	<script language = "JavaScript">
      var apiKey = "4a348f6fbab35c14417e4609c071970f";
	  
	document.addEventListener('DOMContentLoaded', weatherSubmit);
	document.addEventListener('DOMContentLoaded', postSubmit);

	function weatherSubmit(){
		document.getElementById('weatherSubmit').addEventListener('click', function(event){
			var req = new XMLHttpRequest();
			var zip = document.getElementById('zipCode').value;
			req.open("GET", "http://api.openweathermap.org/data/2.5/weather?zip=" + zip + ",us&units=imperial&appid=" + apiKey, true);
			req.addEventListener('load',function(){
		  if(req.status >= 200 && req.status < 400){
			var weather = (JSON.parse(req.responseText));
			document.getElementById("mainTemp").innerHTML = weather.main.temp + " degrees F";
			document.getElementById("mainWeather").innerHTML = weather.weather[0].main;
			document.getElementById("wind").innerHTML = weather.wind.speed + " miles/hour";
		  } else {
			console.log("Error in network request: " + req.statusText);
		  }});
			req.send(null);
			
			event.preventDefault();
		})
	}
		  
	function postSubmit(){
		document.getElementById('postSubmit').addEventListener('click', function(event){
			var req = new XMLHttpRequest();
			var payload = {longUrl:null};
			payload.longUrl = document.getElementById('someText').value;
			req.open('POST', 'http://httpbin.org/post', true);
			req.setRequestHeader('Content-Type', 'application/json');
			req.addEventListener('load',function(){
				if(req.status >= 200 && req.status < 400){
					var response = JSON.parse(req.responseText);
					document.getElementById('textResponse').innerHTML = response.json['longUrl'];
					console.log(JSON.parse(req.responseText));
				} else {
					console.log("Error in network request: " + req.statusText);
				}});
			req.send(JSON.stringify(payload));
			  
			event.preventDefault();
		})
	}
	  
	  
    </script>
  </head>
  <body>
    <form>
      <fieldset>
        <legend>Enter Zip Code</legend>
        <label for="zipCode"></label>
        <input type="text" name="zipCode" id="zipCode">
        <input type="submit" id="weatherSubmit">
      </fieldset>
    </form>
    <div>
      <h2>Result</h2>
      <ul>
        <li><span><b>Weather: </b></span><span id="mainWeather"></span></li>
		<li><span><b>Temp: </b></span><span id="mainTemp"></span></li>
		<li><span><b>Wind Speed: </b></span><span id="wind"></span></li>
      </ul>
    </div>
	<form>
      <fieldset>
        <legend>Enter Some Text and Click Submit</legend>
        <label for="someText"></label>
        <input type="text" name="someText" id="someText">
        <input type="submit" id="postSubmit">
      </fieldset>
    </form>
    <div>
      <h2>The return is:</h2>
      <ul>
        <li><span><b>Response: </b></span><span id="textResponse"></span></li>
      </ul>
    </div>
	
  </body>
</html>